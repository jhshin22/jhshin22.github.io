<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OX í€´ì¦ˆ ì¸ì¦</title>
<style>
    body {
        font-family: "Noto Sans KR", sans-serif;
        margin: 0;
        background-color: #f9f9f9;
        text-align: center;
        font-size: 18px;
        padding: 20px;
    }
    .quiz-box {
        max-width: 600px;
        margin: auto;
        background: white;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .question-text {
        font-size: 20px;
        margin-bottom: 20px;
    }
    button {
        font-size: 20px;
        padding: 15px 25px;
        border-radius: 10px;
        margin: 10px;
        border: none;
        background-color: #1a73e8;
        color: white;
        cursor: pointer;
    }
    button:hover {
        background-color: #0c5cc2;
    }
    #explanation {
        margin-top: 15px;
        font-size: 18px;
        color: #333;
    }
    #smsBtn, #retryBtn {
        display: none;
        background-color: #4CAF50;
    }
    @media (max-width: 600px) {
        body {
            font-size: 20px;
        }
        button {
            font-size: 22px;
            padding: 18px 30px;
            width: 80%;
        }
        .question-text {
            font-size: 22px;
            line-height: 1.5em;
        }
    }
</style>
</head>
<body>

<div class="quiz-box">
    <h2>OX í€´ì¦ˆ</h2>
    <div id="question" class="question-text"></div>
    <div>
        <button onclick="checkAnswer('O')">O</button>
        <button onclick="checkAnswer('X')">X</button>
    </div>
    <div id="explanation"></div>
    <button id="nextBtn" style="display:none;" onclick="nextQuestion()">ë‹¤ìŒ ë¬¸ì œ</button>
    <button id="retryBtn" onclick="retryQuiz()">ë‹¤ì‹œí•˜ê¸°</button>
    <button id="smsBtn" onclick="sendSMS()">ì¸ì¦ì½”ë“œ ì „ì†¡</button>
</div>

<script>
const quizData = [
    { q: "êµë³´ìƒëª…ì€ 1958ë…„ì— ì„¤ë¦½ë˜ì—ˆë‹¤.", a: "O", exp: "ì •ë‹µì…ë‹ˆë‹¤! êµë³´ìƒëª…ì€ 1958ë…„ì— ì„¤ë¦½ë˜ì—ˆìŠµë‹ˆë‹¤." },
    { q: "ë³´í—˜ê³„ì•½ëŒ€ì¶œì€ ì‹ ìš©ì ìˆ˜ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.", a: "O", exp: "ë§ì•„ìš”. ë³´í—˜ê³„ì•½ëŒ€ì¶œì€ ë‹´ë³´ëŒ€ì¶œ ì„±ê²©ì´ë¯€ë¡œ ì‹ ìš©ì ìˆ˜ì— ì§ì ‘ ì˜í–¥ì´ ì—†ìŠµë‹ˆë‹¤." },
    { q: "DSR ê·œì œëŠ” ëª¨ë“  ëŒ€ì¶œì— ë™ì¼í•˜ê²Œ ì ìš©ëœë‹¤.", a: "X", exp: "ì•„ë‹™ë‹ˆë‹¤. ì •ì±…ê¸ˆìœµ, ì¼ë¶€ ë‹´ë³´ëŒ€ì¶œ ë“±ì€ ì œì™¸ë˜ê¸°ë„ í•©ë‹ˆë‹¤." },
    { q: "ì‹ ìš©ëŒ€ì¶œì€ ë¬´ì¡°ê±´ ê¸ˆë¦¬ê°€ ë†’ë‹¤.", a: "X", exp: "ì•„ë‹ˆìš”. ì‹ ìš©ë„, ìš°ëŒ€ì¡°ê±´ ë“±ì— ë”°ë¼ ë‚®ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤." },
    { q: "ë³´í—˜ì„¤ê³„ì‚¬ëŠ” ëŒ€ì¶œìƒí’ˆì„ ì·¨ê¸‰í•  ìˆ˜ ìˆë‹¤.", a: "O", exp: "ë§ìŠµë‹ˆë‹¤. ì¼ì • ì¡°ê±´ì„ ê°–ì¶˜ ì„¤ê³„ì‚¬ëŠ” ëŒ€ì¶œìƒí’ˆ ì•ˆë‚´ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤." }
];

let currentQuestion = 0;
let correctCount = 0;
const secretSalt = "KyoboSecretKey2025"; // ì œì‘ìë§Œ ì•„ëŠ” ë¹„ë°€í‚¤

function loadQuestion() {
    document.getElementById("question").innerText = quizData[currentQuestion].q;
    document.getElementById("explanation").innerText = "";
    document.getElementById("nextBtn").style.display = "none";
}

function checkAnswer(answer) {
    let exp = quizData[currentQuestion].exp;
    if (answer === quizData[currentQuestion].a) {
        correctCount++;
        document.getElementById("explanation").innerHTML = "âœ… ì •ë‹µ!<br>" + exp;
    } else {
        document.getElementById("explanation").innerHTML = "âŒ ì˜¤ë‹µ!<br>" + exp;
    }
    document.getElementById("nextBtn").style.display = "inline-block";
}

function nextQuestion() {
    currentQuestion++;
    if (currentQuestion < quizData.length) {
        loadQuestion();
    } else {
        endQuiz();
    }
}

function endQuiz() {
    if (correctCount === quizData.length) {
        let code = generateCode();
        document.getElementById("question").innerText = "ğŸ‰ ëª¨ë“  ë¬¸ì œë¥¼ ë§í˜”ìŠµë‹ˆë‹¤! ì¸ì¦ì½”ë“œ: " + code;
        document.getElementById("smsBtn").style.display = "inline-block";
    } else {
        document.getElementById("question").innerText = "ğŸ˜¢ ì¼ë¶€ ë¬¸ì œë¥¼ í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
        document.getElementById("retryBtn").style.display = "inline-block";
    }
    document.querySelectorAll("button[onclick^='checkAnswer']").forEach(btn => btn.style.display = "none");
    document.getElementById("nextBtn").style.display = "none";
}

function retryQuiz() {
    currentQuestion = 0;
    correctCount = 0;
    document.querySelectorAll("button[onclick^='checkAnswer']").forEach(btn => btn.style.display = "inline-block");
    document.getElementById("retryBtn").style.display = "none";
    document.getElementById("smsBtn").style.display = "none";
    loadQuestion();
}

function generateCode() {
    let now = new Date();
    let timeStr = `${now.getFullYear()}${now.getMonth()+1}${now.getDate()}${now.getHours()}${now.getMinutes()}`;
    let raw = secretSalt + timeStr;
    let hash = sha256(raw).substring(0, 8);
    return hash;
}

function sendSMS() {
    let code = generateCode();
    let ua = navigator.userAgent.toLowerCase();
    let phoneNumber = "01012345678";
    if (/iphone|ipad|ipod/.test(ua)) {
        window.location.href = `sms:${phoneNumber}&body=${code}`;
    } else {
        window.location.href = `sms:${phoneNumber}?body=${code}`;
    }
}

// SHA-256 í•¨ìˆ˜
function sha256(ascii) {
    const buffer = new TextEncoder().encode(ascii);
    return crypto.subtle.digest("SHA-256", buffer).then(hash => {
        return hex(hash);
    });
}
function hex(buffer) {
    const hexCodes = [];
    const view = new DataView(buffer);
    for (let i = 0; i < view.byteLength; i += 4) {
        const value = view.getUint32(i);
        const stringValue = value.toString(16);
        const padding = '00000000';
        const paddedValue = (padding + stringValue).slice(-padding.length);
        hexCodes.push(paddedValue);
    }
    return hexCodes.join("");
}
// Promise ëŒ€ì‘
function generateCode() {
    let now = new Date();
    let timeStr = `${now.getFullYear()}${now.getMonth()+1}${now.getDate()}${now.getHours()}${now.getMinutes()}`;
    let raw = secretSalt + timeStr;
    let hashPromise = sha256(raw);
    return "ë¡œë”©ì¤‘...";
}
</script>

<script>
// SHA-256 ë™ê¸° ì²˜ë¦¬ ë²„ì „ (Promise ì—†ì´)
function sha256Sync(str) {
    const utf8 = new TextEncoder().encode(str);
    const hashBuffer = new Uint8Array(crypto.subtle.digestSync ? crypto.subtle.digestSync("SHA-256", utf8) : []);
    return Array.from(hashBuffer).map(b => b.toString(16).padStart(2, "0")).join("");
}
function generateCode() {
    let now = new Date();
    let timeStr = `${now.getFullYear()}${now.getMonth()+1}${now.getDate()}${now.getHours()}${now.getMinutes()}`;
    let raw = secretSalt + timeStr;
    return sha256Sync(raw).substring(0, 8);
}
</script>

<script>
loadQuestion();
</script>
</body>
</html>
